<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8">
  <meta name="generator" content="Doxygen 1.8.13">
  <title>SPDK: Changelog</title>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,900" type="text/css">
  <link href="../css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="tabs.css" type="text/css">
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div class="container-fluid">
  <div id="top">  <!-- do not remove this div, it is closed by doxygen! -->
    <div class="row no-gutters">
      <div class="col-xs-12">
        <section id="nav">
          <div class="navbar navbar-default navbar-static-top banner-tabs">
            <ul class="nav navbar-nav">
              <li role="presentation">
                <a href="http://www.spdk.io/">
                  <i class="glyphicon glyphicon-home"></i>
                  <span class="box-name">home</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/releases/">
                  <i class="glyphicon glyphicon-download-alt"></i>
                  <span class="box-name">download</span>
                </a>
              </li>
              <li class="active" role="presentation">
                <a href="index.html">
                  <i class="glyphicon glyphicon-book"></i>
                  <span class="box-name">documentation</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/development/">
                  <i class="glyphicon glyphicon-wrench"></i>
                  <span class="box-name">development</span>
                </a>
              </li>
              <li role="presentation">
                <a href="https://ci.spdk.io/">
                  <i class="glyphicon glyphicon-ok"></i>
                  <span class="box-name">CI status</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/community/">
                  <i class="glyphicon glyphicon-envelope"></i>
                  <span class="box-name">community</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/blog/">
                  <i class="glyphicon glyphicon-comment"></i>
                  <span class="box-name">Blog</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/roadmap/">
                  <i class="glyphicon glyphicon-map-marker"></i>
                  <span class="box-name">Roadmap</span>
                </a>
              </li>
              <li role="presentation">
                <a href="http://www.spdk.io/news/">
                  <i class="glyphicon glyphicon-bullhorn"></i>
                  <span class="box-name">News</span>
                </a>
              </li>
            </ul>
          </div>
        </section>
      </div>
    </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('changelog.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Changelog </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="changelog-v19-01"></a>
v19.01: (Upcoming Release)</h1>
<h2>event framework</h2>
<p>For <code>spdk_app_parse_args</code>, add return value to the callback which parses application specific command line parameters to protect SPDK applications from crashing by invalid values from user input.</p>
<h2>environment</h2>
<p>A new public header file <a class="el" href="env__dpdk_8h.html" title="Encapsulated DPDK specific dependencies. ">env_dpdk.h</a> has been introduced, and function spdk_env_dpdk_post_init is added into it. If user is using DPDK, and already called rte_eal_init, then include <a class="el" href="env__dpdk_8h.html" title="Encapsulated DPDK specific dependencies. ">include/spdk/env_dpdk.h</a>, and call <a class="el" href="env__dpdk_8h.html#a4cad0e2fc2b5a9b8e588bc4e997e2ec7" title="Initialize the environment library after DPDK env is already initialized. ">spdk_env_dpdk_post_init()</a> instead of spdk_env_init.</p>
<h2>util</h2>
<p>A new uuid API <code>spdk_uuid_copy</code> was added to make a copy of the source uuid.</p>
<p>An new parameter <code>init_crc</code> representing the initial CRC value was added to <code>spdk_crc16_t10dif</code>. The parameter can be used to calculate a CRC value spanning multiple separate buffers.</p>
<p>New DIF APIs were added to generate and verify DIF by byte granularity for both DIF and DIX formats. Among them, DIF with copy APIs will be usable to emulate DIF operations such as DIF insert and strip.</p>
<h2>nvme</h2>
<p>Wrapper functions <a class="el" href="nvme_8h.html#ada4ab089f73f3f43e9c5b8e6415e6f50" title="Send security protocol data to controller. ">spdk_nvme_ctrlr_security_send()</a> and <a class="el" href="nvme_8h.html#a5175d6805225d84d6e4aa4e0f1546c69" title="Receive security protocol data from controller. ">spdk_nvme_ctrlr_security_receive()</a> are introduced to support further security protocol development.</p>
<p>admin_timeout_ms was added to NVMe controller initialization options, users can change the default value when probing a controller.</p>
<p>Add two new fields "header_digest" and "data_digest" in struct <a class="el" href="structspdk__nvme__ctrlr__opts.html" title="NVMe controller initialization options. ">spdk_nvme_ctrlr_opts</a>, it will be used to enable the digest support for the NVMe/TCP transport.</p>
<p>Add a new TCP/IP transport(located in lib/nvme/nvme_tcp.c) in nvme driver. With this new transport, it can be used to connect the NVMe-oF target with the same TCP/IP support.</p>
<p>Added API, <a class="el" href="nvme_8h.html#a39c91e2e6ae899f37b5a89c28a2207cf" title="Indicate whether a ctrlr handle is associated with a Discovery controller. ">spdk_nvme_ctrlr_is_discovery()</a>, to indicate whether the ctrlr arg refers to a Discovery Controller or not.</p>
<p>Added an API function <code>spdk_nvme_host_id_parse</code> and corresponding object <code><a class="el" href="structspdk__nvme__host__id.html" title="NVMe host identifier. ">spdk_nvme_host_id</a></code> for parsing host address and host service ID arguments on a per connection basis.</p>
<p>The RPC <code>construct_nvme_bdev</code> now allows a user to specify a source address and service id for the host to use when connecting to the controller backing the NVMe bdev.</p>
<h2>NVMe-oF Target</h2>
<p>The <code>spdk_nvmf_tgt_opts</code> struct has been deprecated in favor of <code><a class="el" href="structspdk__nvmf__transport__opts.html">spdk_nvmf_transport_opts</a></code>. Users will no longer be able to specify target wide I/O parameters. <code>spdk_nvmf_tgt_listen</code> will also no longer implicitly initialize a transport with the default target options (since there are none). Instead, a user must manually instantiate the transport with <code>spdk_nvmf_transport_create</code> prior to calling <code>spdk_nvmf_tgt_listen</code>.</p>
<p>Related to the previous change, the rpc <code>set_nvmf_target_options</code> has been renamed to <code>set_nvmf_target_max_subsystems</code> to indicate that this is the only target option available for the user to edit.</p>
<p>Add an field <code>num_shared_buffers</code> in struct <a class="el" href="structspdk__nvmf__transport__opts.html">spdk_nvmf_transport_opts</a>, and also update the related rpc function nvmf_create_transport, to make this configurable parameter available to users. The <code>num_shared_buffers</code> is used to configure the shared buffer numbers of the transport used by RDMA or TCP transport.</p>
<h2>nvmf</h2>
<p>Add a new TCP/IP transport (located in lib/nvmf/tcp.c). With this tranport, the SPDK NVMe-oF target can have a new transport, and can serve the NVMe-oF protocol via TCP/IP from the host.</p>
<h2>bdev</h2>
<p>On shutdown, bdev unregister now proceeds in top-down fashion, with claimed bdevs skipped (these will be unregistered later, when virtual bdev built on top of the respective base bdev unclaims it). This allows virtual bdevs to be shut down cleanly as opposed to the previous behavior that didn't differentiate between hotremove and planned shutdown.</p>
<h2>logical volumes</h2>
<p>Logical volume bdev can now be marked as read only using <code>set_read_only_lvol_bdev</code> RPC. This allows for basing clones on top of lvol_bdev without first creating a snapshot.</p>
<h2>log</h2>
<p>"trace flags" are now referred to as "log flags" in the SPDK log API. The set_trace_flag, clear_trace_flag and get_trace_flags RPCs are now deprecated, and set_log_flag, clear_log_flag and get_log_flags RPCs have been added.</p>
<h2>trace</h2>
<p>New <code>get_tpoint_group_mask</code> RPC was added to get current tpoint_group_mask, and each tpoint group status. New <code>enable_tpoint_group</code> and <code>disable_tpoint_group</code> RPC were added to enable or disable a specific tpoint group.</p>
<h1><a class="anchor" id="changelog-v18-10"></a>
v18.10:</h1>
<h2>nvme</h2>
<p>spdk_nvme_ctrlr_cmd_security_send() and spdk_nvme_ctrlr_cmd_security_receive() were added to support sending or receiving security protocol data to or from nvme controller.</p>
<p><a class="el" href="nvme_8h.html#a8f3f5c5a738dc7ad7e3b2913bff4324c" title="Get the extended sector size, in bytes, of the given namespace. ">spdk_nvme_ns_get_extended_sector_size()</a> was added. This function includes the metadata size per sector (if any). <a class="el" href="nvme_8h.html#a0d24c0b2b0b2a22b0c0af2ca2e157e04" title="Get the sector size, in bytes, of the given namespace. ">spdk_nvme_ns_get_sector_size()</a> still returns only the data size per sector, not including metadata.</p>
<p>New <code>send_nvme_cmd</code> RPC was added to allow sending NVMe commands directly to NVMe controller. See the <a href="http://spdk.io/doc/jsonrpc.html#rpc_send_nvme_cmd">send_nvme_cmd</a> documentation for more details.</p>
<h2>Build System</h2>
<p>New <code>configure</code> options, <code>--with-shared</code> and <code>--without-shared</code> [default], provide the capability to build, or not, SPDK shared libraries. This includes the single SPDK shared lib encompassing all of the SPDK static libs as well as individual SPDK shared libs corresponding to each of the SPDK static ones. Although the production of the shared libs conforms with conventional version naming practices, such naming does not at this time confer any SPDK ABI compatibility claims.</p>
<h2>bdev</h2>
<p><a class="el" href="bdev__module_8h.html#ae62dae3c4a41154aca74f37864ae82f9" title="Removes all alias from block device alias list. ">spdk_bdev_alias_del_all()</a> was added to delete all alias from block device.</p>
<p>A new virtual bdev module has been added to perform at rest data encryption using the DPDK CryptoDev Framework. The module initially uses a software AESNI CBC cipher with experimental support for the Intel QAT hardware accelerator also currently implemented with support for CBC cipher. Future work may include additional ciphers as well as consideration for authentication.</p>
<p>The RAID virtual bdev module is now always enabled by default. The configure &ndash;with-raid and &ndash;without-raid options are now ignored and deprecated and will be removed in the next release.</p>
<p>Enforcement of bandwidth limits for quality of service (QoS) has been added to the bdev layer. See the new <a href="http://www.spdk.io/doc/jsonrpc.html#rpc_set_bdev_qos_limit">set_bdev_qos_limit</a> documentation for more details. The previous set_bdev_qos_limit_iops RPC method introduced at 18.04 release has been deprecated. The new set_bdev_qos_limit RPC method can support both bandwidth and IOPS limits.</p>
<p>spdk_bdev_config_json() and corresponding <code>get_bdevs_config</code> RPC was removed.</p>
<h2>Environment Abstraction Layer and Event Framework</h2>
<p>The size parameter of spdk_mem_map_translate is now a pointer. This allows the function to report back the actual size of the translation relative to the original request made by the user.</p>
<p>A new structure <a class="el" href="structspdk__mem__map__ops.html" title="A function table to be implemented by each memory map. ">spdk_mem_map_ops</a> has been introduced to hold memory map related callbacks. This structure is now passed as the second argument of spdk_mem_map_alloc in lieu of the notify callback.</p>
<h2>DPDK 18.08</h2>
<p>The DPDK submodule has been updated to the DPDK 18.08 release. SPDK will now automatically utilize DPDK's dynamic memory management with DPDK versions &gt;= 18.05.1.</p>
<p>Hugepages can be still reserved with <code>[-s|--mem-size &lt;size&gt;]</code> option at application startup, but once we use them all up, instead of failing user allocations with -ENOMEM, we'll try to dynamically reserve even more. This allows starting SPDK with <code>--mem-size 0</code> and using only as many hugepages as it is really needed.</p>
<p>Due to this change, the memory buffers returned by <code>spdk_*malloc()</code> are no longer guaranteed to be physically contiguous.</p>
<h2>I/OAT</h2>
<p>I/OAT driver can now reinitialize I/OAT channels after encountering DMA errors.</p>
<h2>iscsi target</h2>
<p>Parameter names of <code>set_iscsi_options</code> and <code>get_iscsi_global_params</code> RPC method for CHAP authentication in discovery sessions have been changed to align with <code>construct_target_node</code> RPC method. Old names are still usable but will be removed in future release.</p>
<p><code>set_iscsi_discovery_auth</code> and <code>set_iscsi_target_node_auth</code> RPC methods have been added to set CHAP authentication for discovery sessions and existing target nodes, respectively.</p>
<p>The SPDK iSCSI target supports an AuthFile which can be used to load CHAP shared secrets when the iSCSI target starts. SPDK previously provided a default location for this file (<code>/usr/local/etc/spdk/auth.conf</code>) if none was specified. This default has been removed. Users must now explicitly specify the location of this file to load CHAP shared secrets from a file, or use the related iSCSI RPC methods to add them at runtime.</p>
<h2>iscsi initiator</h2>
<p>The SPDK iSCSI initiator is no longer considered experimental and becomes a first-class citizen among bdev modules. The basic usage has been briefly described in the bdev user guide: <a href="https://spdk.io/doc/bdev.html#bdev_config_iscsi">iSCSI bdev</a></p>
<h2>Miscellaneous</h2>
<p>The SPDK application framework can now parse long name command line parameters. Most single-character parameters have a long name equivalent now. See the <a href="https://spdk.io/doc/app_overview.html">Command Line Parameters</a> documentation for details or use the <code>--help</code> command line parameter to list all available params.</p>
<p>bdevperf <code>-s</code> param (io size) was renamed to <code>-o</code> as <code>-s</code> had been already used by existing apps for memory size.</p>
<p>bdevio can now accept all SPDK command line parameters. The config now has to be provided with <code>-c</code> or <code>--config</code> param.</p>
<p>The following ioat/perf and nvme/perf parameters were renamed as well: <code>-s</code> (io size) to <code>-o</code> <code>-d</code> (mem size) to <code>-s</code></p>
<p>The ReactorMask config file parameter has been deprecated. Users should use the -m or &ndash;cpumask command line option to specify the CPU core mask for the application.</p>
<p>Default config file pathnames have been removed from iscsi_tgt, nvmf_tgt and vhost. Config file pathnames may now only be specified using the -c command line option.</p>
<p>Users may no longer set DPDK_DIR in their environment to specify the location of the DPDK installation used to build SPDK. Using DPDK_DIR has not been the documented nor recommended way to specify the DPDK location for several releases, but removing it ensures no unexpected surprises for users who may have DPDK_DIR defined for other reasons. Users should just use the "configure" script to specify the DPDK location before building SPDK.</p>
<p>Although we know that many developers still use Python 2 we are officially switching to Python3 with requirement that all new code must be valid also for Python 2 up to the EOL which is year 2020.</p>
<p>Invoking interpreter explicitly is forbidden for executable scripts. There is no need to use syntax like "python ./scripts/rpc.py". All executable scripts must contain proper shebang pointing to the right interpreter. Scripts without shebang musn't be executable.</p>
<p>A Python script has been added to enable conversion of old INI config file to new JSON-RPC config file format. This script can be found at scripts/config_converter.py. Example how this script can be used: </p><div class="fragment"><div class="line">cat old_format.ini | scripts/config_converter.py &gt; new_json_format.json</div></div><!-- fragment --><h2>Sock</h2>
<p>Two additional parameters were added to spdk_sock_get_addr() for the server port and client port. These parameters are named "sport" and "cport" respectively.</p>
<h2>Virtio</h2>
<p>The following RPC commands have been deprecated:</p><ul>
<li>construct_virtio_user_scsi_bdev</li>
<li>construct_virtio_pci_scsi_bdev</li>
<li>construct_virtio_user_blk_bdev</li>
<li>construct_virtio_pci_blk_bdev</li>
<li>remove_virtio_scsi_bdev</li>
</ul>
<p>The <code>construct_virtio_*</code> ones were replaced with a single <code>construct_virtio_dev</code> command that can create any type of Virtio bdev(s). <code>remove_virtio_scsi_bdev</code> was replaced with <code>remove_virtio_bdev</code> that can delete both Virtio Block and SCSI devices.</p>
<h2>Blobfs</h2>
<p><a class="el" href="blobfs_8h.html#a816f18c23723f7211b0a5a277904b202" title="Get the unique ID for the file. ">spdk_file_get_id()</a> returning unique ID for the file was added.</p>
<h2>JSON</h2>
<p>Added jsonrpc-client C library intended for issuing RPC commands from applications.</p>
<p>Added API enabling iteration over JSON object:</p><ul>
<li><a class="el" href="json_8h.html#a5fc65c7d1961c23a747b3e2aa2169f4a" title="Return JSON value asociated with key key_name. ">spdk_json_find()</a></li>
<li><a class="el" href="json_8h.html#a04601f5c6dc82ac1ddedc387a510249d" title="The same as calling spdk_json_find() function with type set to SPDK_JSON_VAL_STRING. ">spdk_json_find_string()</a></li>
<li><a class="el" href="json_8h.html#a0512cd8ee58901ec15f5ef372d6cafc6" title="The same as calling spdk_json_key() function with type set to SPDK_JSON_VAL_ARRAY_BEGIN. ">spdk_json_find_array()</a></li>
<li><a class="el" href="json_8h.html#ae99e0abc8df8354366640d956b1a7461" title="Return first JSON value in given JSON object. ">spdk_json_object_first()</a></li>
<li><a class="el" href="json_8h.html#aabfcbb30424e30c50ab85aae544a73da" title="Return first JSON value in array. ">spdk_json_array_first()</a></li>
<li><a class="el" href="json_8h.html#a4ed2b0ed4b598337db1ef401ccc24b2a" title="Advance to the next JSON value in JSON object or array. ">spdk_json_next()</a></li>
</ul>
<h2>Blobstore</h2>
<p>Blobstore I/O operations are now based on io_units, instead of blobstore page size. The io_unit size is now the same as the underlying block device's block size. Logical volumes built on a block device with 512B block size can now be used as boot devices in QEMU.</p>
<h2>SPDKCLI</h2>
<p>The SPDKCLI interactive command tool for managing SPDK is no longer considered experimental. Support for the iSCSI and NVMe-oF targets has been added.</p>
<h1><a class="anchor" id="changelog-v18-07"></a>
v18.07:</h1>
<h2>bdev</h2>
<p>A new public header file <a class="el" href="bdev__module_8h.html" title="Block Device Module Interface. ">bdev_module.h</a> has been introduced to facilitate the development of new bdev modules. This header includes an interface for the <a class="el" href="structspdk__bdev__part.html">spdk_bdev_part</a> and spdk_bdev_part_base objects to enable the creation of multiple virtual bdevs on top of a single base bdev and should act as the primary API for module authors.</p>
<p>spdk_bdev_get_opts() and spdk_bdev_set_opts() were added to set bdev-wide options.</p>
<p>A mechanism for handling out of memory condition errors (ENOMEM) returned from I/O submission requests at the bdev layer has been added. See <a class="el" href="bdev_8h.html#acc4beee18ded7837fa92bd7c34e7ef2e" title="Add an entry into the calling thread&#39;s queue to be notified when an spdk_bdev_io becomes available...">spdk_bdev_queue_io_wait()</a>.</p>
<p>The <a class="el" href="bdev_8h.html#ab1ba28ba382edd1d792d51a054eb3aa2" title="Return I/O statistics for this channel. ">spdk_bdev_get_io_stat()</a> function now returns cumulative totals instead of resetting on each call. This allows multiple callers to query I/O statistics without conflicting with each other. Existing users will need to adjust their code to record the previous I/O statistics to calculate the delta between calls.</p>
<p>I/O queue depth tracking and samples options have been added. See <a class="el" href="bdev_8h.html#a471f32e8948203f7aaf320396a1ae7c9" title="Get the most recently measured queue depth from a bdev. ">spdk_bdev_get_qd()</a>, <a class="el" href="bdev_8h.html#adab852ac707702316bf869a3d7dfdc85" title="Get the queue depth polling period. ">spdk_bdev_get_qd_sampling_period()</a>, and <a class="el" href="bdev_8h.html#a9d37ad1d4da0bcb51ada76dbe4f4ce15" title="Enable or disable queue depth sampling for this bdev. ">spdk_bdev_set_qd_sampling_period()</a>.</p>
<h2>RAID module</h2>
<p>A new bdev module called "raid" has been added as experimental module which aggregates underlying NVMe bdevs and exposes a single raid bdev. Please note that vhost will not work with this module because it does not yet have support for multi-element io vectors.</p>
<h2>Log</h2>
<p>The debug log component flag available on several SPDK applications has been renamed from <code>-t</code> to <code>-L</code> to prevent confusion with tracepoints and to allow the option to be added to tools that already use <code>-t</code> to mean something else.</p>
<h2>Blobstore</h2>
<p>A new function, <a class="el" href="blob_8h.html#aa75072ce1a5a9559fe2db0da30363ad4" title="Dump a blobstore&#39;s metadata to a given FILE in human-readable format. ">spdk_bs_dump()</a>, has been added that dumps all of the contents of a blobstore to a file pointer. This includes the metadata and is very useful for debugging.</p>
<p>Two new operations have been added for thin-provisioned blobs. <a class="el" href="blob_8h.html#a3d1f1b56d9782997ef3e338879a2fa28" title="Allocate all clusters in this blob. ">spdk_bs_inflate_blob()</a> will allocate clusters for all thinly provisioned regions of the blob and populate them with the correct data by reading from the backing blob(s). <a class="el" href="blob_8h.html#a7dee33b6b9df9b9a3d6b9957c71a779c" title="Remove dependency on parent blob. ">spdk_bs_blob_decouple_parent()</a> works similarly, but will only allocate clusters that correspond to data in the blob's immediate parent. Clusters allocated to grandparents or that aren't allocated at all will remain thin-provisioned.</p>
<h2>BlobFS</h2>
<p>Changed the return type of <a class="el" href="blobfs_8h.html#ada22d1c3ca951dff8380854b3726d8c1" title="Truncate the file. ">spdk_file_truncate()</a> from void to int to allow the propagation of <code>ENOMEM</code> errors.</p>
<h2>NVMe Driver</h2>
<p>The new API functions <a class="el" href="nvme_8h.html#acf6188764b8c71b2f64a74077d6bfabf" title="Inject an error for the next request with a given opcode. ">spdk_nvme_qpair_add_cmd_error_injection()</a> and <a class="el" href="nvme_8h.html#ad720b23786450b5a2b2d7d65c6dd6b7c" title="Clear the specified NVMe command with error status. ">spdk_nvme_qpair_remove_cmd_error_injection()</a> have been added for NVMe error emulation. Users can set a specified command to fail with a particular error status.</p>
<p>Changed the name <code>timeout_sec</code> parameter to <code>timeout_us</code> in <a class="el" href="nvme_8h.html#aecec86e033e0d13e6fc67ead61a7028d" title="Register for timeout callback on a controller. ">spdk_nvme_ctrlr_register_timeout_callback()</a>, and also changed the type from uint32_t to uint64_t. This will give users more fine-grained control over the timeout period.</p>
<p>Basic support for Open Channel SSDs was added. See <a class="el" href="nvme__ocssd_8h.html" title="NVMe driver public API extension for Open-Channel. ">nvme_ocssd.h</a></p>
<h2>NVMe Over Fabrics</h2>
<p>The <a class="el" href="nvmf_8h.html#a21638f4d81002e93d410cd0d267f608c" title="Destroy an NVMe-oF target. ">spdk_nvmf_tgt_destroy()</a> function is now asynchronous and takes a callback as a parameter.</p>
<p><a class="el" href="nvmf_8h.html#afa33cb1cf39e04ee533f874ed82e24e5" title="Disconnect an NVMe-oF qpair. ">spdk_nvmf_qpair_disconnect()</a> was added to allow the user to disconnect qpairs.</p>
<p><a class="el" href="nvmf_8h.html#a414b91bad7200ab931f14a06585ccc74" title="Get the maximum number of namespaces allowed in a subsystem. ">spdk_nvmf_subsystem_get_max_namespaces()</a> was added to query the maximum allowed number of namespaces for a given subsystem.</p>
<h2>Build System</h2>
<p>The build system now generates a combined shared library (libspdk.so) that may be used in place of the individual static libraries (libspdk_*.a). The combined library includes all components of SPDK and is intended to make linking against SPDK easier. The static libraries are also still provided for users that prefer to link only the minimal set of components required.</p>
<h2>git pre-commit and pre-push hooks</h2>
<p>The pre-commit hook will run <code>scripts/check_format.sh</code> and verify there are no formating errors before allowing <code>git commit</code> to run. The pre-push hook runs <code>make CONFIG_WERROR=y</code> with and without <code>CONFIG_DEBUG=y</code> using both the gcc and clang compiler before allowing <code>git push</code> to run. Following each DEBUG build <code>test/unit/unittest.sh</code> is run and verified. Results are recorded in the <code>make.log</code> file.</p>
<p>To enable type: 'git config core.hooksPath .githooks'. To override after configuration use the <code>git --no-verify</code> flag.</p>
<h2>RPC</h2>
<p>The <code>start_nbd_disk</code> RPC method now returns the path to the kernel NBD device node rather than always returning <code>true</code>.</p>
<h2>DPDK 18.05</h2>
<p>The DPDK submodule has been rebased on the DPDK 18.05 release. DPDK 18.05 supports dynamic memory allocation, but due to some issues found after the DPDK 18.05 release, that support is not enabled for SPDK 18.07. Therefore, SPDK 18.07 will continue to use the legacy memory allocation model. The plan is to enable dynamic memory allocation after the DPDK 18.08 release which should fix these issues.</p>
<h2>Environment Abstraction Layer and Event Framework</h2>
<p>The <a class="el" href="env_8h.html#a99549dc9905683f1dea50ff79d0c5651" title="Look up the translation of a virtual address in a memory map. ">spdk_mem_map_translate()</a> function now takes a size parameter to indicate the size of the memory region. This can be used by environment implementations to validate the requested translation.</p>
<p>The I/O Channel implementation has been moved to its own library - lib/thread. The public API that was previously in <a class="el" href="io__channel_8h.html" title="IO channel. ">spdk/io_channel.h</a> is now in <a class="el" href="thread_8h.html" title="Thread. ">spdk/thread.h</a> The file <a class="el" href="io__channel_8h.html" title="IO channel. ">spdk/io_channel.h</a> remains and includes <a class="el" href="thread_8h.html" title="Thread. ">spdk/thread.h</a>.</p>
<p>spdk_reactor_get_tsc_stats was added to return interesting statistics for each reactor.</p>
<h2>IOAT</h2>
<p>IOAT for copy engine is disabled by default. It can be enabled by specifying the Enable option with "Yes" in <code>[Ioat]</code> section of the configuration file. The Disable option is now deprecated and will be removed in a future release.</p>
<h1><a class="anchor" id="changelog-v18-04"></a>
v18.04: Logical Volume Snapshot/Clone, iSCSI Initiator, Bdev QoS, VPP Userspace TCP/IP</h1>
<h2>vhost</h2>
<p>The SPDK vhost-scsi, vhost-blk and vhost-nvme applications have fixes to address the DPDK rte_vhost vulnerability <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1059">CVE-2018-1059</a>. Please see this <a href="https://access.redhat.com/security/cve/cve-2018-1059">security advisory</a> for additional information on the DPDK vulnerability.</p>
<p>Workarounds have been added to ensure vhost compatibility with QEMU 2.12.</p>
<p>EXPERIMENTAL: Support for vhost-nvme has been added to the SPDK vhost target. See the <a href="http://www.spdk.io/doc/vhost.html">vhost documentation</a> for more details.</p>
<h2>Unified Target Application</h2>
<p>A new unified SPDK target application, <code>spdk_tgt</code>, has been added. This application combines the functionality of several existing SPDK applications, including the iSCSI target, NVMe-oF target, and vhost target. The new application can be managed through the existing configuration file and <a href="http://www.spdk.io/doc/jsonrpc.html">JSON-RPC</a> methods.</p>
<h2>Env</h2>
<p><a class="el" href="env_8h.html#a5695d9dcc6f53a561f41c932a198853b" title="Get multiple elements from a memory pool. ">spdk_mempool_get_bulk()</a> has been added to wrap DPDK rte_mempool_get_bulk().</p>
<p>New memory management functions <a class="el" href="env_8h.html#a668370523a786a75a7d08a8e8f4b28b9" title="Allocate dma/sharable memory based on a given dma_flg. ">spdk_malloc()</a>, <a class="el" href="env_8h.html#a49ad245dae3554cf96d62e9b2b0b1596" title="Allocate dma/sharable memory based on a given dma_flg. ">spdk_zmalloc()</a>, and <a class="el" href="env_8h.html#a452d670d7188f883224574dfabc39f2c" title="Free buffer memory that was previously allocated with spdk_malloc() or spdk_zmalloc(). ">spdk_free()</a> have been added. These new functions have a <code>flags</code> parameter that allows the user to specify whether the allocated memory needs to be suitable for DMA and whether it should be shared across processes with the same shm_id. The new functions are intended to replace <a class="el" href="env_8h.html#a0874731c44ac31e4b14d91c6844a87d1" title="Allocate a pinned memory buffer with the given size and alignment. ">spdk_dma_malloc()</a> and related functions, which will eventually be deprecated and removed.</p>
<h2>Bdev</h2>
<p>A new optional bdev module interface function, <code>init_complete</code>, has been added to notify bdev modules when the bdev subsystem initialization is complete. This may be useful for virtual bdevs that require notification that the set of initialization examine() calls is complete.</p>
<p>The bdev layer now allows modules to provide an optional per-bdev UUID, which can be retrieved with the <a class="el" href="bdev_8h.html#add8565cdbf3d57697b67202b869a7beb" title="Get a bdev&#39;s UUID. ">spdk_bdev_get_uuid()</a> function.</p>
<p>Enforcement of IOPS limits for quality of service (QoS) has been added to the bdev layer. See the <a href="http://www.spdk.io/doc/jsonrpc.html#rpc_set_bdev_qos_limit_iops">set_bdev_qos_limit_iops</a> documentation for more details.</p>
<h2>RPC</h2>
<p>The <code>[Rpc]</code> configuration file section, which was deprecated in v18.01, has been removed. Users should switch to the <code>-r</code> command-line parameter instead.</p>
<p>The JSON-RPC server implementation now allows up to 32 megabyte responses, growing as needed; previously, the response was limited to 32 kilobytes.</p>
<h2>SPDKCLI</h2>
<p>EXPERIMENTAL: New SPDKCLI interactive command tool for managing SPDK is available. See the <a href="http://www.spdk.io/doc/spdkcli.html">SPDKCLI</a> documentation for more details.</p>
<h2>NVMe Driver</h2>
<p>EXPERIMENTAL: Support for WDS and RDS capable CMBs in NVMe controllers has been added. This support is experimental pending a functional allocator to free and reallocate CMB buffers.</p>
<p><a class="el" href="nvme_8h.html#a6c559063408299a4612fd2e62f97bc63" title="Get the UUID for the given namespace. ">spdk_nvme_ns_get_uuid()</a> has been added to allow retrieval of per-namespace UUIDs when available.</p>
<p>New API functions <a class="el" href="nvme_8h.html#a59e69f39c7cb8a9e1c3e00af7804c8bd" title="Get the nsid of the first active namespace. ">spdk_nvme_ctrlr_get_first_active_ns()</a> and <a class="el" href="nvme_8h.html#abcd528b0df0a564c218dc2745c3af159" title="Get next active namespace given the previous nsid. ">spdk_nvme_ctrlr_get_next_active_ns()</a> have been added to iterate active namespaces, as well as <a class="el" href="nvme_8h.html#abbcdb6e7c22b0ef87ed927bf97952c19" title="Check whether the nsid is an active nv for the given NVMe controller. ">spdk_nvme_ctrlr_is_active_ns()</a> to check if a namespace ID is active.</p>
<h2>NVMe-oF Target</h2>
<p>Namespaces may now be assigned unique identifiers via new optional <code>eui64</code> and <code>nguid</code> parameters to the <code>nvmf_subsystem_add_ns</code> RPC method. Additionally, the NVMe-oF target automatically exposes the backing bdev's UUID as the namespace UUID when available.</p>
<p><a class="el" href="nvmf_8h.html#a7fafa9106b94d650f0c1daa5c6d7090e" title="Remove a namespace from a subsytem. ">spdk_nvmf_subsystem_remove_ns()</a> is now asynchronous and requires a callback to indicate completion.</p>
<h2>Blobstore</h2>
<p>A number of functions have been renamed:</p>
<ul>
<li>spdk_bs_io_write_blob() =&gt; <a class="el" href="blob_8h.html#a2835355d4266676fa6db5c987c506a77" title="Write data to a blob. ">spdk_blob_io_write()</a></li>
<li>spdk_bs_io_read_blob() =&gt; <a class="el" href="blob_8h.html#a8753efc66a7bc29a63ae74730959b9c1" title="Read data from a blob. ">spdk_blob_io_read()</a></li>
<li>spdk_bs_io_writev_blob() =&gt; <a class="el" href="blob_8h.html#afa2fed3283426fb3ddf6abc61a44266b" title="Write the data described by &#39;iov&#39; to &#39;length&#39; pages beginning at &#39;offset&#39; pages into the blob...">spdk_blob_io_writev()</a></li>
<li>spdk_bs_io_readv_blob() =&gt; <a class="el" href="blob_8h.html#ade242e483bcb3a50bb987acf2e0dfd4e" title="Read &#39;length&#39; pages starting at &#39;offset&#39; pages into the blob into the memory described by &#39;iov&#39;...">spdk_blob_io_readv()</a></li>
<li>spdk_bs_io_unmap_blob() =&gt; <a class="el" href="blob_8h.html#a2dea7bc3f6cc4dcd2b5d039b14b8640a" title="Unmap &#39;length&#39; pages beginning at &#39;offset&#39; pages on the blob as unused. ">spdk_blob_io_unmap()</a></li>
<li>spdk_bs_io_write_zeroes_blob() =&gt; <a class="el" href="blob_8h.html#a0291498c4cac92556e0e7e7bf286bda6" title="Write zeros into area of a blob. ">spdk_blob_io_write_zeroes()</a></li>
</ul>
<p>The old names still exist but are deprecated. They will be removed in the v18.07 release.</p>
<p><a class="el" href="blob_8h.html#a70993dda1206b4c0aaa76deb2b6fd13c" title="Resize a blob to &#39;sz&#39; clusters. ">spdk_blob_resize()</a> is now an asynchronous operation to enable resizing a blob while I/O are in progress to that blob on other threads. An explicit <a class="el" href="blob_8h.html#a5acc48debefc30773518871e4f84480f" title="Sync a blob. ">spdk_blob_sync_md()</a> is still required to sync the updated metadata to disk.</p>
<h2>Logical Volumes</h2>
<p>A new <code>destroy_lvol_bdev</code> RPC method to delete logical volumes has been added.</p>
<p>Lvols now have their own UUIDs which replace previous LvolStoreUUID_BlobID combination.</p>
<p>New Snapshot and Clone functionalities have been added. User may create Snapshots of existing Lvols and Clones of existing Snapshots. See the <a href="http://www.spdk.io/doc/logical_volumes.html#lvol_snapshots">lvol snapshots</a> documentation for more details.</p>
<p>Resizing logical volumes is now supported via the <code>resize_lvol_bdev</code> RPC method.</p>
<h2>Lib</h2>
<p>A set of changes were made in the SPDK's lib code altering instances of calls to <code>exit()</code> and <code>abort()</code> to return a failure instead wherever reasonably possible.</p>
<p><a class="el" href="event_8h.html#a18879873a585b21f44b7c90be8726ce1" title="Start the framework. ">spdk_app_start()</a> no longer exit()'s on an internal failure, but instead returns a non-zero error status.</p>
<p><a class="el" href="event_8h.html#acc52e8c68c8ccec4640e14f687157afe" title="Helper function for parsing arguments and printing usage messages. ">spdk_app_parse_args()</a> no longer exit()'s on help, '-h', or an invalid option, but instead returns SPDK_APP_PARSE_ARGS_HELP and SPDK_APP_PARSE_ARGS_FAIL, respectively, and SPDK_APP_PARSE_ARGS_SUCCESS on success.</p>
<p>spdk_pci_get_device() has been deprecated and will be removed in SPDK v18.07.</p>
<h2>I/O Channels</h2>
<p>The prototype for <a class="el" href="thread_8h.html#a35c421accdc2a0a61bb7be916106293b" title="Callback function for a poller. ">spdk_poller_fn()</a> has been modified; it now returns a value indicating whether or not the poller did any work. Existing pollers will need to be updated to return a value.</p>
<h2>iSCSI Target</h2>
<p>The SPDK iSCSI target now supports the fd.io Vector Packet Processing (VPP) framework userspace TCP/IP stack. See the <a href="http://www.spdk.io/doc/iscsi.html#vpp">iSCSI VPP documentation</a> for more details.</p>
<h2>iSCSI initiator</h2>
<p>An iSCSI initiator bdev module has been added to SPDK. This module should be considered experimental pending additional features and tests. More details can be found in lib/bdev/iscsi/README.</p>
<h2>PMDK</h2>
<p>The persistent memory (PMDK) bdev module is now enabled using <code>--with-pmdk</code> instead of <code>--with-nvml</code>. This reflects the renaming of the persistent memory library from NVML to PMDK.</p>
<h2>Virtio Block driver</h2>
<p>A userspace driver for Virtio Block devices has been added. It was built on top of the <a href="http://www.spdk.io/doc/virtio.html">Virtio</a> library and can be managed similarly to the Virtio SCSI driver. See the <a href="http://www.spdk.io/doc/bdev.html#bdev_config_virtio_blk">Virtio Block</a> reference for more information.</p>
<h2>Virtio with 2MB hugepages</h2>
<p>The previous 1GB hugepage limitation has now been lifted. A new <code>-g</code> command-line option enables SPDK Virtio to work with 2MB hugepages. See <a href="http://www.spdk.io/doc/virtio.html#virtio_2mb">2MB hugepages</a> for details.</p>
<h1><a class="anchor" id="changelog-v18-01"></a>
v18.01: Blobstore Thin Provisioning</h1>
<h2>Build System</h2>
<p>The build system now includes a <code>make install</code> rule, including support for the common <code>DESTDIR</code> and <code>prefix</code> variables as used in other build systems. Additionally, the prefix may be set via the configure <code>--prefix</code> option. Example: <code>make install prefix=/usr</code>.</p>
<h2>RPC</h2>
<p>A JSON RPC listener is now enabled by default using a UNIX domain socket at /var/run/spdk.sock. A -r option command line option has been added to enable an alternative UNIX domain socket location, or a TCP port in the format ip_addr:tcp_port (i.e. 127.0.0.1:5260). The Rpc configuration file section is now deprecated and will be removed in the v18.04 release.</p>
<h2>I/O Channels</h2>
<p><a class="el" href="thread_8h.html#a6b3e883ddce01ae8d93541304d1e9126" title="Register a poller on the current thread. ">spdk_poller_register()</a> and <a class="el" href="thread_8h.html#a9c26cbd781063f5ee627d6aba2c73fe3" title="Unregister a poller on the current thread. ">spdk_poller_unregister()</a> were moved from the event framework (<a class="el" href="event_8h.html" title="Event framework public API. ">include/spdk/event.h</a>) to the I/O channel library (<a class="el" href="io__channel_8h.html" title="IO channel. ">include/spdk/io_channel.h</a>). This allows code that doesn't depend on the event framework to request registration and unregistration of pollers.</p>
<p><a class="el" href="thread_8h.html#aa7a2ca9bd0497544e852c65fd5263cd1" title="Call &#39;fn&#39; on each channel associated with io_device. ">spdk_for_each_channel()</a> now allows asynchronous operations during iteration. Instead of immediately continuing the interation upon returning from the iteration callback, the user must call <a class="el" href="thread_8h.html#a4e87fc8c0fc870769c068a2752cdc359" title="Helper function to iterate all channels for spdk_for_each_channel(). ">spdk_for_each_channel_continue()</a> to resume iteration.</p>
<h2>Block Device Abstraction Layer (bdev)</h2>
<p>The poller abstraction was removed from the bdev layer. There is now a general purpose abstraction for pollers available in <a class="el" href="io__channel_8h.html" title="IO channel. ">include/spdk/io_channel.h</a></p>
<h2>Lib</h2>
<p>A set of changes were made in the SPDK's lib code altering, instances of calls to <code>exit()</code> and <code>abort()</code> to return a failure instead wherever reasonably possible. This has resulted in return type changes of the API for:</p>
<ul>
<li><a class="el" href="env_8h.html#a402ca8ae67be57c2c258a7a2bf22cfec" title="Initialize the environment library. ">spdk_env_init()</a> from type <code>void</code> to <code>int</code>.</li>
<li>spdk_mem_map_init() from type <code>void</code> to <code>int</code>.</li>
</ul>
<p>Applications making use of these APIs should be modified to check for a non-zero return value instead of relying on them to fail without return.</p>
<h2>NVMe Driver</h2>
<p>SPDK now supports hotplug for vfio-attached devices. But there is one thing keep in mind: Only physical removal events are supported; removing devices via the sysfs <code>remove</code> file will not work.</p>
<h2>NVMe-oF Target</h2>
<p>Subsystems are no longer tied explicitly to CPU cores. Instead, connections are handed out to the available cores round-robin. The "Core" option in the configuration file has been removed.</p>
<h2>Blobstore</h2>
<p>A number of functions have been renamed:</p>
<ul>
<li>spdk_bs_md_resize_blob() =&gt; <a class="el" href="blob_8h.html#a70993dda1206b4c0aaa76deb2b6fd13c" title="Resize a blob to &#39;sz&#39; clusters. ">spdk_blob_resize()</a></li>
<li>spdk_bs_md_sync_blob() =&gt; <a class="el" href="blob_8h.html#a5acc48debefc30773518871e4f84480f" title="Sync a blob. ">spdk_blob_sync_md()</a></li>
<li>spdk_bs_md_close_blob() =&gt; <a class="el" href="blob_8h.html#ac6ca1e83e9608eb1dea9fca62881d350" title="Close a blob. ">spdk_blob_close()</a></li>
<li>spdk_bs_md_get_xattr_names() =&gt; <a class="el" href="blob_8h.html#ab9b3d20a4be55b2c2ba046a2ccfe7233" title="Iterate through all extended attributes of the blob. ">spdk_blob_get_xattr_names()</a></li>
<li>spdk_bs_md_get_xattr_value() =&gt; <a class="el" href="blob_8h.html#afe49b3a95d13aed755726bed94f79344" title="Get the value of the specified extended attribute. ">spdk_blob_get_xattr_value()</a></li>
<li>spdk_blob_md_set_xattr() =&gt; <a class="el" href="blob_8h.html#a74beed7022f23df295149fd68ac8935d" title="Set an extended attribute for the given blob. ">spdk_blob_set_xattr()</a></li>
<li>spdk_blob_md_remove_xattr() =&gt; <a class="el" href="blob_8h.html#a5c836667ea7f3c5fa5b2e3bf486d8428" title="Remove the extended attribute from the given blob. ">spdk_blob_remove_xattr()</a></li>
<li>spdk_bs_md_create_blob() =&gt; <a class="el" href="blob_8h.html#a33263462543c5f2b51f4d507ea26a58d" title="Create a new blob with default option values on the given blobstore. ">spdk_bs_create_blob()</a></li>
<li>spdk_bs_md_open_blob() =&gt; <a class="el" href="blob_8h.html#a2c60e6bc3ccd26228dec2c0f3ecfe618" title="Open a blob from the given blobstore. ">spdk_bs_open_blob()</a></li>
<li>spdk_bs_md_delete_blob() =&gt; <a class="el" href="blob_8h.html#aed4fb5871f9ca58ff60c0dd8810eb223" title="Delete an existing blob from the given blobstore. ">spdk_bs_delete_blob()</a></li>
<li>spdk_bs_md_iter_first() =&gt; <a class="el" href="blob_8h.html#af173fe4e35623b8dc8256e9141700486" title="Get the first blob of the blobstore. ">spdk_bs_iter_first()</a></li>
<li>spdk_bs_md_iter_next() =&gt; <a class="el" href="blob_8h.html#a98d90e701cf3377115ff0bb67db1342a" title="Get the next blob by using the current blob. ">spdk_bs_iter_next()</a></li>
</ul>
<p>The function signature of <a class="el" href="blob_8h.html#ac6ca1e83e9608eb1dea9fca62881d350" title="Close a blob. ">spdk_blob_close()</a> has changed. It now takes a struct spdk_blob * argument rather than struct spdk_blob **.</p>
<p>The function signature of <a class="el" href="blob_8h.html#a98d90e701cf3377115ff0bb67db1342a" title="Get the next blob by using the current blob. ">spdk_bs_iter_next()</a> has changed. It now takes a struct spdk_blob * argument rather than struct spdk_blob **.</p>
<p>Thin provisioning support has been added to the blobstore. It can be enabled by setting the <code>thin_provision</code> flag in struct <a class="el" href="structspdk__blob__opts.html">spdk_blob_opts</a> when calling <a class="el" href="blob_8h.html#a3c00efe656ca70fc5e8f2f477b8e48ed" title="Create a new blob with options on the given blobstore. ">spdk_bs_create_blob_ext()</a>.</p>
<h2>NBD device</h2>
<p>The NBD application (test/lib/bdev/nbd) has been removed; Same functionality can now be achieved by using the test/app/bdev_svc application and start_nbd_disk RPC method. See the <a href="http://www.spdk.io/doc/bdev.html#bdev_config_gpt">GPT</a> documentation for more details.</p>
<h2>FIO plugin</h2>
<p>SPDK <code>fio_plugin</code> now supports FIO 3.3. The support for previous FIO 2.21 has been dropped, although it still remains to work for now. The new FIO contains huge amount of bugfixes and it's recommended to do an update.</p>
<h2>Virtio library</h2>
<p>Previously a part of the bdev_virtio module, now a separate library. Virtio is now available via <code>spdk_internal/virtio.h</code> file. This is an internal interface to be used when implementing new Virtio backends, namely Virtio-BLK.</p>
<h2>iSCSI</h2>
<p>The MinConnectionIdleInterval parameter has been removed, and connections are no longer migrated to an epoll/kqueue descriptor on the master core when idle.</p>
<h1><a class="anchor" id="changelog-v17-10"></a>
v17.10: Logical Volumes</h1>
<h2>New dependencies</h2>
<p>libuuid was added as new dependency for logical volumes.</p>
<p>libnuma is now required unconditionally now that the DPDK submodule has been updated to DPDK 17.08.</p>
<h2>Block Device Abstraction Layer (bdev)</h2>
<p>An <a href="http://github.com/axboe/fio">fio</a> plugin was added that can route I/O to the bdev layer. See the <a href="https://github.com/spdk/spdk/tree/master/examples/bdev/fio_plugin/">plugin documentation</a> for more information.</p>
<p><a class="el" href="group__bdev__io__submit__functions.html#ga680c9c302998f7b003e2476e35d9ae4b" title="Submit an unmap request to the block device. ">spdk_bdev_unmap()</a> was modified to take an offset and a length in bytes as arguments instead of requiring the user to provide an array of SCSI unmap descriptors. This limits unmaps to a single contiguous range.</p>
<p><a class="el" href="group__bdev__io__submit__functions.html#gadc50b78fec7f69190d9139aff29a9043" title="Submit a write zeroes request to the bdev on the given channel. ">spdk_bdev_write_zeroes()</a> was introduced. It ensures that all specified blocks will be zeroed out. If a block device doesn't natively support a write zeroes command, the bdev layer emulates it using write commands.</p>
<p>New API functions that accept I/O parameters in units of blocks instead of bytes have been added:</p><ul>
<li><a class="el" href="group__bdev__io__submit__functions.html#gaeec9efd151e2fb34ee3d22a1edbbb53f" title="Submit a read request to the bdev on the given channel. ">spdk_bdev_read_blocks()</a>, <a class="el" href="group__bdev__io__submit__functions.html#ga55483d5ae010c514b37b976ad803b4b2" title="Submit a read request to the bdev on the given channel. ">spdk_bdev_readv_blocks()</a></li>
<li><a class="el" href="group__bdev__io__submit__functions.html#ga12da8917f525a6e11cbf22b2b7652c89" title="Submit a write request to the bdev on the given channel. ">spdk_bdev_write_blocks()</a>, <a class="el" href="group__bdev__io__submit__functions.html#gaf5849064d12de9f140a41522d1f7c95b" title="Submit a write request to the bdev on the given channel. ">spdk_bdev_writev_blocks()</a></li>
<li><a class="el" href="group__bdev__io__submit__functions.html#ga047f8a9f8d0a3d1d7bfcdf0a9838b261" title="Submit a write zeroes request to the bdev on the given channel. ">spdk_bdev_write_zeroes_blocks()</a></li>
<li><a class="el" href="group__bdev__io__submit__functions.html#ga7555fdd41019e29b40e535b72457d30b" title="Submit an unmap request to the block device. ">spdk_bdev_unmap_blocks()</a></li>
</ul>
<p>The bdev layer now handles temporary out-of-memory I/O failures internally by queueing the I/O to be retried later.</p>
<h2>Linux AIO bdev</h2>
<p>The AIO bdev now allows the user to override the auto-detected block size.</p>
<h2>NVMe driver</h2>
<p>The NVMe driver now recognizes the NVMe 1.3 Namespace Optimal I/O Boundary field. NVMe 1.3 devices may report an optimal I/O boundary, which the driver will take into account when splitting I/O requests.</p>
<p>The HotplugEnable option in <code>[Nvme]</code> sections of the configuration file is now "No" by default. It was previously "Yes".</p>
<p>The NVMe library now includes a <a class="el" href="nvme_8h.html#a2640aeebb82108e9b507dcccb1e564c2" title="Get the controller with which this namespace is associated. ">spdk_nvme_ns_get_ctrlr()</a> function which returns the NVMe Controller associated with a given namespace.</p>
<p>The NVMe library now allows the user to specify a host identifier when attaching to a controller. The host identifier is used as part of the Reservations feature, as well as in the NVMe-oF Connect command. The default host ID is also now a randomly-generated UUID, and the default host NQN uses the host ID to generate a UUID-based NQN.</p>
<p><a class="el" href="nvme_8h.html#ae26375a74c2c935ec32f0c41a7ed93df" title="Connect the NVMe driver to the device located at the given transport ID. ">spdk_nvme_connect()</a> was added to allow the user to connect directly to a single NVMe or NVMe-oF controller.</p>
<h2>NVMe-oF Target (nvmf_tgt)</h2>
<p>The NVMe-oF target no longer requires any in-capsule data buffers to run, and the feature is now entirely optional. Previously, at least 4 KiB in-capsule data buffers were required.</p>
<p>NVMe-oF subsytems have a new configuration option, AllowAnyHost, to control whether the host NQN whitelist is enforced when accepting new connections. If no Host options have been specified and AllowAnyHost is disabled, the connection will be denied; this is a behavior change from previous releases, which allowed any host NQN to connect if the Host list was empty. AllowAnyHost is disabled by default.</p>
<p>NVMe-oF namespaces may now be assigned arbitrary namespace IDs, and the number of namespaces per subsystem is no longer limited.</p>
<p>The NVMe-oF target now supports the Write Zeroes command.</p>
<h2>Environment Abstraction Layer</h2>
<p>A new default value, SPDK_MEMPOOL_DEFAULT_CACHE_SIZE, was added to provide additional clarity when constructing spdk_mempools. Previously, -1 could be passed and the library would choose a reasonable default, but this new value makes it explicit that the default is being used.</p>
<h2>Blobstore</h2>
<p>The blobstore super block now contains a bstype field to identify the type of the blobstore. Existing code should be updated to fill out bstype when calling <a class="el" href="blob_8h.html#ad59f1d147b612a7d4ce1eb8439a69cee" title="Initialize a blobstore on the given device. ">spdk_bs_init()</a> and <a class="el" href="blob_8h.html#a400da20b69e4f914730fbd15d51eb748" title="Load a blobstore from the given device. ">spdk_bs_load()</a>.</p>
<p><a class="el" href="blob_8h.html#a0ba54d7b0d88a136bbfc9f93bc10b87d" title="Destroy the blobstore. ">spdk_bs_destroy()</a> was added to allow destroying blobstore on device with an initialized blobstore.</p>
<p>spdk_bs_io_readv_blob() and spdk_bs_io_writev_blob() were added to enable scattered payloads.</p>
<p>A CLI tool for blobstore has been added, allowing basic operations through either command line or shell interface. See the <a href="https://github.com/spdk/spdk/tree/master/examples/blob/cli">blobcli</a> documentation for more details.</p>
<h2>Event Framework</h2>
<p>The ability to set a thread name, previously only used by the reactor code, is now part of the spdk_thread_allocate() API. Users may specify a thread name which will show up in tools like <code>gdb</code>.</p>
<h2>Log</h2>
<p>The spdk_trace_dump() function now takes a new parameter to allow the caller to specify an output file handle (stdout or stderr, for example).</p>
<h2>Logical Volumes</h2>
<p>Logical volumes library built on top of SPDK blobstore has been added. It is possible to create logical volumes on top of other devices using RPC.</p>
<p>See the <a href="http://www.spdk.io/doc/logical_volumes.html">logical volumes</a> documentation for more information.</p>
<h2>Persistent Memory</h2>
<p>A new persistent memory bdev type has been added. The persistent memory block device is built on top of <a href="http://pmem.io/nvml/libpmemblk/">libpmemblk</a>. It is possible to create pmem devices on top of pmem pool files using RPC.</p>
<p>See the <a href="http://www.spdk.io/doc/bdev.html#bdev_config_pmem">Pmem Block Device</a> documentation for more information.</p>
<h2>Virtio SCSI driver</h2>
<p>A userspace driver for Virtio SCSI devices has been added. The driver is capable of creating block devices on top of LUNs exposed by another SPDK vhost-scsi application.</p>
<p>See the <a href="http://www.spdk.io/doc/virtio.html">Virtio SCSI</a> documentation and <a href="http://www.spdk.io/doc/bdev.html#bdev_config_virtio_scsi">Getting Started</a> guide for more information.</p>
<h2>Vhost target</h2>
<p>The vhost target application now supports live migration between QEMU instances.</p>
<h1><a class="anchor" id="changelog-v17-07"></a>
v17.07: Build system improvements, userspace vhost-blk target, and GPT bdev</h1>
<h2>Build System</h2>
<p>A <code>configure</code> script has been added to simplify the build configuration process. The existing CONFIG file and <code>make CONFIG_...</code> options are also still supported. Run <code>./configure --help</code> for information about available configuration options.</p>
<p>A DPDK submodule has been added to make building SPDK easier. If no <code>--with-dpdk</code> option is specified to configure, the SPDK build system will automatically build a known-good configuration of DPDK with the minimal options enabled. See the Building section of README.md for more information.</p>
<p>A <a href="https://www.vagrantup.com/">Vagrant</a> setup has been added to make it easier to develop and use SPDK on systems without suitable NVMe hardware. See the Vagrant section of README.md for more information.</p>
<h2>Userspace vhost-blk target</h2>
<p>The vhost library and example app have been updated to support the vhost-blk protocol in addition to the existing vhost-scsi protocol. See the <a href="http://www.spdk.io/doc/vhost.html">vhost documentation</a> for more details.</p>
<h2>Block device abstraction layer (bdev)</h2>
<p>A GPT virtual block device has been added, which automatically exposes GPT partitions with a special SPDK-specific partition type as bdevs. See the <a href="http://www.spdk.io/doc/bdev.md#bdev_config_gpt">GPT bdev documentation</a> for more information.</p>
<h2>NVMe driver</h2>
<p>The NVMe driver has been updated to support recent Intel SSDs, including the Intel® Optane™ SSD DC P4800X series.</p>
<p>A workaround has been added for devices that failed to recognize register writes during controller reset.</p>
<p>The NVMe driver now allocates request tracking objects on a per-queue basis. The number of requests allowed on an I/O queue may be set during <code><a class="el" href="nvme_8h.html#a225bbc386ec518ae21bd5536f21db45d" title="Enumerate the bus indicated by the transport ID and attach the userspace NVMe driver to each device f...">spdk_nvme_probe()</a></code> by modifying <code>io_queue_requests</code> in the opts structure.</p>
<p>The SPDK NVMe <code>fio_plugin</code> has been updated to support multiple threads (<code>numjobs</code>).</p>
<p><a class="el" href="nvme_8h.html#a13f745d239dab9b8f934fae2ad4984a2" title="Allocate an I/O queue pair (submission and completion queue). ">spdk_nvme_ctrlr_alloc_io_qpair()</a> has been modified to allow the user to override controller-level options for each individual I/O queue pair. Existing callers with qprio == 0 can be updated to: </p><div class="fragment"><div class="line">... = spdk_nvme_ctrlr_alloc_io_qpair(ctrlr, NULL, 0);</div></div><!-- fragment --><p> Callers that need to specify a non-default qprio should be updated to: </p><div class="fragment"><div class="line">struct spdk_nvme_io_qpair_opts opts;</div><div class="line">spdk_nvme_ctrlr_get_default_io_qpair_opts(ctrlr, &amp;opts, sizeof(opts));</div><div class="line">opts.qprio = SPDK_NVME_QPRIO_...;</div><div class="line">... = spdk_nvme_ctrlr_alloc_io_qpair(ctrlr, &amp;opts, sizeof(opts));</div></div><!-- fragment --><h2>Environment Abstraction Layer</h2>
<p>The environment abstraction layer has been updated to include several new functions in order to wrap additional DPDK functionality. See <code><a class="el" href="env_8h.html" title="Encapsulated third-party dependencies. ">include/spdk/env.h</a></code> for the current set of functions.</p>
<h2>SPDK Performance Analysis with Intel® VTune™ Amplifier</h2>
<p>Support for SPDK performance analysis has been added to Intel® VTune™ Amplifier 2018.</p>
<p>This analysis provides:</p><ul>
<li>I/O performance monitoring (calculating standard I/O metrics like IOPS, throughput, etc.)</li>
<li>Tuning insights on the interplay of I/O and compute devices by estimating how many cores would be reasonable to provide for SPDK to keep up with a current storage workload.</li>
</ul>
<p>See the VTune Amplifier documentation for more information.</p>
<h1><a class="anchor" id="changelog-v17-03"></a>
v17.03: Blobstore and userspace vhost-scsi target</h1>
<h2>Blobstore and BlobFS</h2>
<p>The blobstore is a persistent, power-fail safe block allocator designed to be used as the local storage system backing a higher-level storage service. See the <a href="http://www.spdk.io/doc/blob.html">blobstore documentation</a> for more details.</p>
<p>BlobFS adds basic filesystem functionality like filenames on top of the blobstore. This release also includes a RocksDB Env implementation using BlobFS in place of the kernel filesystem. See the <a href="http://www.spdk.io/doc/blobfs.html">BlobFS documentation</a> for more details.</p>
<h2>Userspace vhost-scsi target</h2>
<p>A userspace implementation of the QEMU vhost-scsi protocol has been added. The vhost target is capable of exporting SPDK bdevs to QEMU-based VMs as virtio devices. See the <a href="http://www.spdk.io/doc/vhost.html">vhost documentation</a> for more details.</p>
<h2>Event framework</h2>
<p>The overhead of the main reactor event loop was reduced by optimizing the number of calls to <a class="el" href="env_8h.html#a7d868d272aa0c000f6135966dfadc596" title="Get a monotonic timestamp counter. ">spdk_get_ticks()</a> per iteration.</p>
<h2>NVMe library</h2>
<p>The NVMe library will now automatically split readv/writev requests with scatter-gather lists that do not map to valid PRP lists when the NVMe controller does not natively support SGLs.</p>
<p>The <code>identify</code> and <code>perf</code> NVMe examples were modified to add a consistent format for specifying remote NVMe over Fabrics devices via the <code>-r</code> option. This is implemented using the new <code><a class="el" href="nvme_8h.html#ac37484cc5d14777e4ae1fde031d0edf2" title="Parse the string representation of a transport ID. ">spdk_nvme_transport_id_parse()</a></code> function.</p>
<h2>iSCSI Target</h2>
<p>The [Nvme] section of the configuration file was modified to remove the <code>BDF</code> directive and replace it with a <code>TransportID</code> directive. Both local (PCIe) and remote (NVMe-oF) devices can now be specified as the backing block device. A script to generate an entire [Nvme] section based on the local NVMe devices attached was added at <code>scripts/gen_nvme.sh</code>.</p>
<h2>NVMe-oF Target</h2>
<p>The [Nvme] section of the configuration file was modified to remove the <code>BDF</code> directive and replace it with a <code>TransportID</code> directive. Both local (PCIe) and remote (NVMe-oF) devices can now be specified as the backing block device. A script to generate an entire [Nvme] section based on the local NVMe devices attached was added at <code>scripts/gen_nvme.sh</code>.</p>
<h1><a class="anchor" id="changelog-v16-12"></a>
v16.12: NVMe over Fabrics host, hotplug, and multi-process</h1>
<h2>NVMe library</h2>
<p>The NVMe library has been changed to create its own request memory pool rather than requiring the user to initialize the global <code>request_mempool</code> variable. Apps can be updated by simply removing the initialization of <code>request_mempool</code>. Since the NVMe library user no longer needs to know the size of the internal NVMe request structure to create the pool, the <code>spdk_nvme_request_size()</code> function was also removed.</p>
<p>The <code>spdk_nvme_ns_cmd_deallocate()</code> function was renamed and extended to become <code><a class="el" href="nvme_8h.html#ac0c646dd18675c54ffcf834ce699658d" title="Submit a data set management request to the specified NVMe namespace. ">spdk_nvme_ns_cmd_dataset_management()</a></code>, which allows access to all of the NVMe Dataset Management command's parameters. Existing callers can be updated to use <code><a class="el" href="nvme_8h.html#ac0c646dd18675c54ffcf834ce699658d" title="Submit a data set management request to the specified NVMe namespace. ">spdk_nvme_ns_cmd_dataset_management()</a></code> with <code>SPDK_NVME_DSM_ATTR_DEALLOCATE</code> as the <code>type</code> parameter.</p>
<p>The NVMe library SGL callback prototype has been changed to return virtual addresses rather than physical addresses. Callers of <code><a class="el" href="nvme_8h.html#acb47ce7de6b6e963ec9fb8de261466ae" title="Submit a read I/O to the specified NVMe namespace. ">spdk_nvme_ns_cmd_readv()</a></code> and <code><a class="el" href="nvme_8h.html#adfcbb5d31f0b572847cc8ae8b07dfcfb" title="Submit a write I/O to the specified NVMe namespace. ">spdk_nvme_ns_cmd_writev()</a></code> must update their <code>next_sge_fn</code> callbacks to match.</p>
<p>The NVMe library now supports NVMe over Fabrics devices in addition to the existing support for local PCIe-attached NVMe devices. For an example of how to enable NVMe over Fabrics support in an application, see <code>examples/nvme/identify</code> and <code>examples/nvme/perf</code>.</p>
<p>Hot insert/remove support for NVMe devices has been added. To enable NVMe hotplug support, an application should call the <code><a class="el" href="nvme_8h.html#a225bbc386ec518ae21bd5536f21db45d" title="Enumerate the bus indicated by the transport ID and attach the userspace NVMe driver to each device f...">spdk_nvme_probe()</a></code> function on a regular basis to probe for new devices (reported via the existing <code>probe_cb</code> callback) and removed devices (reported via a new <code>remove_cb</code> callback). Hotplug is currently only supported on Linux with the <code>uio_pci_generic</code> driver, and newly-added NVMe devices must be bound to <code>uio_pci_generic</code> by an external script or tool.</p>
<p>Multiple processes may now coordinate and use a single NVMe device simultaneously using <a href="http://dpdk.org/doc/guides/prog_guide/multi_proc_support.html">DPDK Multi-process Support</a>.</p>
<h2>NVMe over Fabrics target (<code>nvmf_tgt</code>)</h2>
<p>The <code>nvmf_tgt</code> configuration file format has been updated significantly to enable new features. See the example configuration file <code>etc/spdk/nvmf.conf.in</code> for more details on the new and changed options.</p>
<p>The NVMe over Fabrics target now supports virtual mode subsystems, which allow the user to export devices from the SPDK block device abstraction layer as NVMe over Fabrics subsystems. Direct mode (raw NVMe device access) is also still supported, and a single <code>nvmf_tgt</code> may export both types of subsystems simultaneously.</p>
<h2>Block device abstraction layer (bdev)</h2>
<p>The bdev layer now supports scatter/gather read and write I/O APIs, and the NVMe blockdev driver has been updated to support scatter/gather. Apps can use the new scatter/gather support via the <code><a class="el" href="group__bdev__io__submit__functions.html#ga9ac9efa882e87909acfd4bccaddb1778" title="Submit a read request to the bdev on the given channel. ">spdk_bdev_readv()</a></code> and <code><a class="el" href="group__bdev__io__submit__functions.html#ga9a508a1c301a1321faf0680a8f31f59a" title="Submit a write request to the bdev on the given channel. ">spdk_bdev_writev()</a></code> functions.</p>
<p>The bdev status returned from each I/O has been extended to pass through NVMe or SCSI status codes directly in cases where the underlying device can provide a more specific status code.</p>
<p>A Ceph RBD (RADOS Block Device) blockdev driver has been added. This allows the <code>iscsi_tgt</code> and <code>nvmf_tgt</code> apps to export Ceph RBD volumes as iSCSI LUNs or NVMe namespaces.</p>
<h2>General changes</h2>
<p><code>libpciaccess</code> has been removed as a dependency and DPDK PCI enumeration is used instead. Prior to DPDK 16.07 enumeration by class code was not supported, so for earlier DPDK versions, only Intel SSD DC P3x00 devices will be discovered by the NVMe library.</p>
<p>The <code>env</code> environment abstraction library has been introduced, and a default DPDK-based implementation is provided as part of SPDK. The goal of the <code>env</code> layer is to enable use of alternate user-mode memory allocation and PCI access libraries. See <code>doc/porting.md</code> for more details.</p>
<p>The build process has been modified to produce all of the library files in the <code>build/lib</code> directory. This is intended to simplify the use of SPDK from external projects, which can now link to SPDK libraries by adding the <code>build/lib</code> directory to the library path via <code>-L</code> and linking the SPDK libraries by name (for example, <code>-lspdk_nvme -lspdk_log -lspdk_util</code>).</p>
<p><code>nvmf_tgt</code> and <code>iscsi_tgt</code> now have a JSON-RPC interface, which allows the user to query and modify the configuration at runtime. The RPC service is disabled by default, since it currently does not provide any authentication or security mechanisms; it should only be enabled on systems with controlled user access behind a firewall. An example RPC client implemented in Python is provided in <code>scripts/rpc.py</code>.</p>
<h1><a class="anchor" id="changelog-v16-08"></a>
v16.08: iSCSI target, NVMe over Fabrics maturity</h1>
<p>This release adds a userspace iSCSI target. The iSCSI target is capable of exporting NVMe devices over a network using the iSCSI protocol. The application is located in app/iscsi_tgt and a documented configuration file can be found at etc/spdk/spdk.conf.in.</p>
<p>This release also significantly improves the existing NVMe over Fabrics target.</p><ul>
<li>The configuration file format was changed, which will require updates to any existing nvmf.conf files (see <code>etc/spdk/nvmf.conf.in</code>):<ul>
<li><code>SubsystemGroup</code> was renamed to <code>Subsystem</code>.</li>
<li><code>AuthFile</code> was removed (it was unimplemented).</li>
<li><code>nvmf_tgt</code> was updated to correctly recognize NQN (NVMe Qualified Names) when naming subsystems. The default node name was changed to reflect this; it is now "nqn.2016-06.io.spdk".</li>
<li><code>Port</code> and <code>Host</code> sections were merged into the <code>Subsystem</code> section</li>
<li>Global options to control max queue depth, number of queues, max I/O size, and max in-capsule data size were added.</li>
<li>The Nvme section was removed. Now a list of devices is specified by bus/device/function directly in the Subsystem section.</li>
<li>Subsystems now have a Mode, which can be Direct or Virtual. This is an attempt to future-proof the interface, so the only mode supported by this release is "Direct".</li>
</ul>
</li>
<li>Many bug fixes and cleanups were applied to the <code>nvmf_tgt</code> app and library.</li>
<li>The target now supports discovery.</li>
</ul>
<p>This release also adds one new feature and provides some better examples and tools for the NVMe driver.</p><ul>
<li>The Weighted Round Robin arbitration method is now supported. This allows the user to specify different priorities on a per-I/O-queue basis. To enable WRR, set the <code>arb_mechanism</code> field during <code><a class="el" href="nvme_8h.html#a225bbc386ec518ae21bd5536f21db45d" title="Enumerate the bus indicated by the transport ID and attach the userspace NVMe driver to each device f...">spdk_nvme_probe()</a></code>.</li>
<li>A simplified "Hello World" example was added to show the proper way to use the NVMe library API; see <code>examples/nvme/hello_world/hello_world.c</code>.</li>
<li>A test for measuring software overhead was added. See <code>test/lib/nvme/overhead</code>.</li>
</ul>
<h1><a class="anchor" id="changelog-v16-06"></a>
v16.06: NVMf userspace target</h1>
<p>This release adds a userspace NVMf (NVMe over Fabrics) target, conforming to the newly-released NVMf 1.0/NVMe 1.2.1 specification. The NVMf target exports NVMe devices from a host machine over the network via RDMA. Currently, the target is limited to directly exporting physical NVMe devices, and the discovery subsystem is not supported.</p>
<p>This release includes a general API cleanup, including renaming all declarations in public headers to include a <code>spdk</code> prefix to prevent namespace clashes with user code.</p>
<ul>
<li>NVMe<ul>
<li>The <code>nvme_attach()</code> API was reworked into a new probe/attach model, which moves device detection into the NVMe library. The new API also allows parallel initialization of NVMe controllers, providing a major reduction in startup time when using multiple controllers.</li>
<li>I/O queue allocation was changed to be explicit in the API. Each function that generates I/O requests now takes a queue pair (<code>spdk_nvme_qpair *</code>) argument, and I/O queues may be allocated using <code><a class="el" href="nvme_8h.html#a13f745d239dab9b8f934fae2ad4984a2" title="Allocate an I/O queue pair (submission and completion queue). ">spdk_nvme_ctrlr_alloc_io_qpair()</a></code>. This allows more flexible assignment of queue pairs than the previous model, which only allowed a single queue per thread and limited the total number of I/O queues to the lowest number supported on any attached controller.</li>
<li>Added support for the Write Zeroes command.</li>
<li><code>examples/nvme/perf</code> can now report I/O command latency from the the controller's viewpoint using the Intel vendor-specific read/write latency log page.</li>
<li>Added namespace reservation command support, which can be used to coordinate sharing of a namespace between multiple hosts.</li>
<li>Added hardware SGL support, which enables use of scattered buffers that don't conform to the PRP list alignment and length requirements on supported NVMe controllers.</li>
<li>Added end-to-end data protection support, including the ability to write and read metadata in extended LBA (metadata appended to each block of data in the buffer) and separate metadata buffer modes. See <code><a class="el" href="nvme_8h.html#adc2aa2be0d657be0c63d5abc02b274ec" title="Submit a write I/O to the specified NVMe namespace. ">spdk_nvme_ns_cmd_write_with_md()</a></code> and <code><a class="el" href="nvme_8h.html#aa2913b93326e636eca6dfe7b42e349fe" title="Submits a read I/O to the specified NVMe namespace. ">spdk_nvme_ns_cmd_read_with_md()</a></code> for details.</li>
</ul>
</li>
<li>IOAT<ul>
<li>The DMA block fill feature is now exposed via the <code>ioat_submit_fill()</code> function. This is functionally similar to <code>memset()</code>, except the memory is filled with an 8-byte repeating pattern instead of a single byte like memset.</li>
</ul>
</li>
<li>PCI<ul>
<li>Added support for using DPDK for PCI device mapping in addition to the existing libpciaccess option. Using the DPDK PCI support also allows use of the Linux VFIO driver model, which means that SPDK userspace drivers will work with the IOMMU enabled. Additionally, SPDK applications may be run as an unprivileged user with access restricted to a specific set of PCIe devices.</li>
<li>The PCI library API was made more generic to abstract away differences between the underlying PCI access implementations.</li>
</ul>
</li>
</ul>
<h1>v1.2.0: IOAT user-space driver</h1>
<p>This release adds a user-space driver with support for the Intel I/O Acceleration Technology (I/OAT, also known as "Crystal Beach") DMA offload engine.</p>
<ul>
<li>IOAT<ul>
<li>New user-space driver supporting DMA memory copy offload</li>
<li>Example programs <code>ioat/perf</code> and <code>ioat/verify</code></li>
<li>Kernel-mode DMA engine test driver <code>kperf</code> for performance comparison</li>
</ul>
</li>
<li>NVMe<ul>
<li>Per-I/O flags for Force Unit Access (FUA) and Limited Retry</li>
<li>Public API for retrieving log pages</li>
<li>Reservation register/acquire/release/report command support</li>
<li>Scattered payload support - an alternate API to provide I/O buffers via a sequence of callbacks</li>
<li>Declarations and <code>nvme/identify</code> support for Intel SSD DC P3700 series vendor-specific log pages and features</li>
</ul>
</li>
<li>Updated to support DPDK 2.2.0</li>
</ul>
<h1>v1.0.0: NVMe user-space driver</h1>
<p>This is the initial open source release of the Storage Performance Development Kit (SPDK).</p>
<p>Features:</p><ul>
<li>NVMe user-space driver</li>
<li>NVMe example programs<ul>
<li><code>examples/nvme/perf</code> tests performance (IOPS) using the NVMe user-space driver</li>
<li><code>examples/nvme/identify</code> displays NVMe controller information in a human-readable format</li>
</ul>
</li>
<li>Linux and FreeBSD support </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
</div>
